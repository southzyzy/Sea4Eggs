###################################
##### Default Configurations ######
###################################
en
conf t
hostname MGMT_SW

########################
##### Disable CDP ######
########################
no cdp run

################################
##### Disable HTTP servers #####
################################
no ip http server
no ip http secure-server

###################################
##### Set logging level to 6 ######
###################################
logging 172.16.67.2
logging trap 6

login on-success log
login on-failure log

#######################
##### Config NTP ######
#######################
clock timezone SGT 8
ntp server 172.16.67.2 prefer
ntp logging

##################################
##### Configure Access Ports #####
##################################
! Change all ports to access and set to nonegotiate
int range g1/0/1-28
switchport mode access
switchport nonegotiate
shut

! No shut for interface to MGNT Router
int g1/0/24
no shut
exit

! Configure Used Ports
int range g1/0/1-6
no shut
exit

##############################################
##### Configure Security on Unused Ports #####
##############################################
! Shutdown Mangement Port
int fa0
no ip address
no ip route-cache
shut

int range g1/0/1-6
switchport port-security
switchport port-security maximum 8
switchport port-security violation shutdown
switchport port-security mac-address sticky
no shut
exit

int range g1/0/7-23
switchport access vlan 99
switchport port-security 
switchport port-security violation shutdown
switchport port-security maximum 1
switchport port-security mac-address sticky
spanning-tree bpduguard enable
shut
exit

! Unused ports from 25-28
int range g1/0/25-28
switchport access vlan 99
switchport port-security 
switchport port-security violation shutdown
switchport port-security maximum 1
switchport port-security mac-address sticky
spanning-tree bpduguard enable
shut
exit

#####################################
##### Set up SVI for management #####
#####################################
int vlan 1
description MANAGEMENT
ip address 172.16.68.3 255.255.255.240

###########################################
##### Configure DHCP snooping and DAI #####
###########################################
ip dhcp snooping
ip arp inspection vlan 1
ip dhcp snooping verify mac-address

#################################
### Configure ARP Inspection ####
#################################
int range g1/0/1-6
ip arp inspection trust
int g1/0/24
ip arp inspection trust
exit

##################################################
##### Set ARP Inspection Rate on end devices #####
##################################################
int range g1/0/7-23
ip arp inspection limit rate 100
int range g1/0/25-28
ip arp inspection limit rate 100
exit

###########################################################
##### Validate layer 2 information to ARP information #####
###########################################################
ip arp inspection validate src-mac dst-mac ip

########################################
##### Set IPSG, with ip-mac filter #####
########################################
ip source binding 00e0.4c79.31e8 vlan 1 172.16.68.12 interface g1/0/7

##########################
##### Enable TACACS+ #####
##########################
aaa new-model
tacacs server TACACSERVER
address ipv4 172.16.68.8
key Sea4EggsC0mpl3xP@ssw0rd
exit
ip tacacs source-interface vlan 1

#########################################
##### Set TACACS+ AAA configuration #####
#########################################
aaa authentication login default group tacacs+ local
aaa authentication enable default group tacacs+ enable

aaa authorization commands 15 default group tacacs+ local

aaa accounting commands 0 default start-stop group tacacs+
aaa accounting commands 15 default start-stop group tacacs+

###############################
##### Test authentication #####
###############################
test aaa group tacacs+ network_manager Rapes&Redwine legacy

##########################################
##### Enable privilege mode password #####
##########################################
enable algorithm-type sha256 secret SW2C0mpl3xP@ssw0rd

########################################################
##### Create local account for local authentication ####
######### Do not use unless absolutely required ########
########################################################
username sea4eggs-admin privilege 15 algorithm-type sha256 secret 1qwer$#@!~sea4eggs

##########################################
##### Enable ssh on virtual terminal #####
##########################################
line vty 0 15 
transport input ssh
login authentication default
exit

######################
##### Enable SSH #####
######################
ip domain-name intranet.sea4eggs.sitict.net
crypto key generate rsa modulus 2048
ip ssh version 2

end
