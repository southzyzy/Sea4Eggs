en
conf t
hostname TheGreatWall

logging 172.16.67.2 

interface GigabitEthernet0/0
 nameif EDGE-WAN
 security-level 0
 ip address 172.16.0.2 255.255.255.252 
!
interface GigabitEthernet0/1
 nameif MGNT-SYSLOG
 security-level 100
 ip address 172.16.4.1 255.255.255.252 
!
interface GigabitEthernet0/2
 nameif DMZ
 security-level 50
 ip address 172.16.3.1 255.255.255.252 
!
interface GigabitEthernet0/3
 shutdown
 no nameif    
 no security-level
 no ip address
!             
interface GigabitEthernet0/4
 nameif L3SW1 
 security-level 80
 ip address 172.16.1.1 255.255.255.252 
!             
interface GigabitEthernet0/5
 nameif L3SW2 
 security-level 80
 ip address 172.16.2.1 255.255.255.252 
!             
interface Management0/0
 management-only
 nameif management
 security-level 100
 ip address 172.16.68.2 255.255.255.240 
!         

! Static routes
route EDGE-WAN 0.0.0.0 0.0.0.0 172.16.0.1 1
route MGNT-SYSLOG 172.16.67.0 255.255.255.252 172.16.4.2 1
route MGNT-SYSLOG 172.16.68.0 255.255.255.240 172.16.4.2 1
route DMZ 172.16.81.0 255.255.255.252 172.16.3.2 1

route L3SW1 172.16.30.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.31.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.37.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.66.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.100.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.110.0 255.255.255.240 172.16.1.2 1
route L3SW1 172.16.200.0 255.255.255.248 172.16.1.2 1
route L3SW1 172.16.210.0 255.255.255.224 172.16.1.2 200

route L3SW2 172.16.30.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.31.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.37.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.66.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.100.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.110.0 255.255.255.240 172.16.2.2 200
route L3SW2 172.16.200.0 255.255.255.248 172.16.2.2 200
route L3SW2 172.16.210.0 255.255.255.224 172.16.2.2 1



! ---------- CHECK IF NEED TO BE REPLACED @ZHAOXIANG ---------- !
class-map http_WebServer
match access-list PERMIT_WAN_TO_DMZ
exit

policy-map policy_WebServer
class http_WebServer
set connection embryonic-conn-max 10 per-client-embryonic-max 5
set connection per-client-max 10
set connection timeout idle 0:0:10
exit
service-policy policy_WebServer interface EDGE-WAN
! --------------------------------------------------------------! 


! -----------------------------------
! Create object groups for networks
object-group network PARTNERS
network-object 172.16.100.0 255.255.255.248
exit
object-group network ASSOCIATES
network-object 172.16.110.0 255.255.255.240
exit
object-group network LAW_CLERKS
network-object 172.16.200.0 255.255.255.248
exit
object-group network LEGAL_SECRETARIES
network-object 172.16.210.0 255.255.255.224
exit
object-group network IT_SUPPORT
network-object 172.16.30.0 255.255.255.248
exit
object-group network MARKETING_LEADS
network-object 172.16.31.0 255.255.255.248
exit
object-group network CHIEF_LEGAL_OFFICE
network-object 172.16.37.0 255.255.255.248
exit
object-group network INTERNAL_SERVER_FARM
network-object 172.16.66.0 255.255.255.248
exit
object-group network SYSLOG
network-object 172.16.67.0 255.255.255.252
exit
object-group network MANAGEMENT_VLAN
network-object 172.16.68.0 255.255.255.240
exit
object-group network HONEYPOT
network-object 172.16.69.0 255.255.255.252
exit
object-group network DMZ
network-object host 172.16.81.2
exit

! Define the internal network object group
object-group network INTERNAL_NETWORK
group-object PARTNERS
group-object ASSOCIATES
group-object LAW_CLERKS
group-object LEGAL_SECRETARIES
group-object IT_SUPPORT
group-object MARKETING_LEADS
group-object CHIEF_LEGAL_OFFICE
group-object INTERNAL_SERVER_FARM
exit

object-group network WAN_FACING_SERVICES
group-object DMZ
group-object HONEYPOT
exit

object-group network MANAGEMENT_NETWORK
group-object MANAGEMENT_VLAN
group-object SYSLOG
exit

object-group service SYSLOG_AND_NTP_TRAFFIC
service-object udp destination eq 123
service-object udp destination eq 514
service-object udp destination eq 9997
exit

object-group service DMZ_TRAFFIC
service-object tcp destination eq 80
service-object tcp-udp destination eq 53
exit

! -----------------------------------
! ACL to permit syslog traffic from edge router and DMZ router towards SYSLOG server
access-list CUSTOM_SYSLOG extended permit object-group SYSLOG_AND_NTP_TRAFFIC host 172.16.0.1 object-group SYSLOG
access-list CUSTOM_SYSLOG extended permit object-group SYSLOG_AND_NTP_TRAFFIC host 172.16.3.2 object-group SYSLOG
access-list CUSTOM_SYSLOG extended permit object-group SYSLOG_AND_NTP_TRAFFIC host 172.16.81.2 object-group SYSLOG
access-list CUSTOM_SYSLOG extended deny object-group SYSLOG_AND_NTP_TRAFFIC any any

! Apply SYSLOG ACL (for network devices) to firewall interface facing MGNT Router
access-group CUSTOM_SYSLOG out interface EDGE-WAN
access-group CUSTOM_SYSLOG out interface DMZ

! ACL to permit Outside to DMZ
access-list PERMIT_WAN_TO_DMZ extended permit object-group DMZ_TRAFFIC any4 object-group DMZ

! Apply the WEB ACL to firewall interface facing the edge router
access-group PERMIT_WAN_TO_DMZ in interface EDGE-WAN

! ACL to restrict internal network to HONEY
access-list RESTRICT_HONEY_IN extended deny ip object-group INTERNAL_NETWORK object-group HONEYPOT

! Restrict HONEYPOT outbound traffic
access-group RESTRICT_HONEY_IN in interface L3SW1
access-group RESTRICT_HONEY_IN in interface L3SW2
exit
! -----------------------------------


# TODO
ACL from OUTSIDE_TO_VPN

end
